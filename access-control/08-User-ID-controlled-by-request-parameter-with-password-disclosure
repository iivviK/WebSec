LAB: User ID controlled by request parameter with password disclosure  
Kategoria: Access Control / IDOR / Sensitive Data Exposure  
Utworzono: 2026-01-25 12:04 (Europe/Amsterdam)

---

1. CEL TESTU

   Celem testu było sprawdzenie, czy aplikacja poprawnie egzekwuje
   kontrolę dostępu do profili użytkowników oraz czy możliwy jest
   wyciek haseł w przypadku manipulacji parametrem identyfikującym
   użytkownika w URL.

---

2. KONTEKST APLIKACJI

   - Aplikacja webowa typu e-commerce
   - Użytkownik testowy: wiener:peter
   - Profil użytkownika dostępny pod /my-account?id=<username>
   - Panel administracyjny dostępny dla konta administratora

---

3. RECONNAISSANCE (UI)

   3.1. Po zalogowaniu użytkownik trafia na:
        /my-account?id=wiener

   3.2. Parametr `id` w URL odpowiada nazwie użytkownika
        i determinuje kontekst wyświetlanego profilu.

---

4. ANALIZA LOGIKI BIZNESOWEJ

   Backend:
   - ufa parametrowi `id` przekazanemu przez klienta
   - nie weryfikuje, czy żądany profil należy do zalogowanego użytkownika
   - renderuje pełny widok profilu na podstawie samego parametru URL

---

5. IDENTYFIKACJA POTENCJALNEJ PODATNOŚCI

   Obecność parametru `id` sugeruje możliwość:
   - bezpośredniego odwołania do obiektu użytkownika (IDOR)
   - eskalacji poziomej (horizontal privilege escalation)

---

6. TEST – MANIPULACJA PARAMETREM ID

   Zmieniono parametr w URL:

   /my-account?id=wiener  
   → /my-account?id=carlos

   Backend zwrócił pełny widok profilu użytkownika carlos.

---

7. OBSERWACJA – WYCIĘK HASŁA

   W odpowiedzi HTTP (200 OK) znaleziono formularz zmiany hasła,
   zawierający aktualne hasło użytkownika w atrybucie `value`:

   <input type="password" value="..."/>

   Hasło było zwrócone w postaci jawnej (plaintext).

---

8. EKSPLOATACJA – DOSTĘP DO KONTA ADMINA

   Analogicznie zmieniono parametr:

   /my-account?id=administrator

   Efekt:
   - uzyskano dostęp do profilu administratora
   - możliwe było przejście do panelu administracyjnego

---

9. FINALNA AKCJA

   Z poziomu panelu administracyjnego:
   - usunięto konto użytkownika `carlos`

   Po tej akcji lab został oznaczony jako „Solved”.

---

10. IMPACT

   - Pełne ujawnienie haseł użytkowników
   - Możliwość przejęcia dowolnego konta
   - Eskalacja do konta administratora
   - Całkowite złamanie kontroli dostępu

---

11. KLASYFIKACJA PODATNOŚCI

   - Typ: IDOR (Insecure Direct Object Reference)
   - Dodatkowo: Password Disclosure
   - Kategoria: Broken Access Control
   - Poziom ryzyka: Critical

   Root Cause:
   - Brak walidacji właściciela zasobu
   - Renderowanie wrażliwych danych po stronie backendu

---

12. WNIOSKI I REKOMENDACJE

   12.1. Backend powinien:
         - nigdy nie zwracać haseł (ani jawnych, ani haszy) w response
         - weryfikować, czy użytkownik ma prawo do żądanego profilu

   12.2. Kontrola dostępu:
         - musi opierać się na sesji, nie na parametrach URL
         - powinna być egzekwowana przed generowaniem odpowiedzi

   12.3. Metodologicznie:
         - zawsze analizować formularze i atrybuty `value`
         - traktować wyciek hasła jako podatność krytyczną
